#!/bin/zsh

# Installation file
#
# Usage:
# ./install
#
# This script automatic install:
# - Oh My ZSH
#   - Spaceship theme
#   - ZSH Syntax Highlighting
#   - ZSH Autosuggestions
# - Create symbolic links for configurations

NO_COLOR='\e[0m'
BLACK='\e[0;30m'
GRAY='\e[37m'
RED='\e[0;31m'
GREEN='\e[0;32m'
YELLOW='\e[0;33m'
BLUE='\e[0;34m'
PURPLE='\e[0;35m'
CYAN='\e[0;36m'
WHITE='\e[0;37m'
BOLD_BLACK='\e[1;30m'
BOLD_RED='\e[1;31m'
BOLD_GREEN='\e[1;32m'
BOLD_YELLOW='\e[1;33m'
BOLD_BLUE='\e[1;34m'
BOLD_PURPLE='\e[1;35m'
BOLD_CYAN='\e[1;36m'
BOLD_WHITE='\e[1;37m'

INFO="${BLUE}[!]${NO_COLOR}"
SUCCESS="${GREEN}[âœ“]${NO_COLOR}"
ERROR="${GREEN}[âœ˜]${NO_COLOR}"
DONE="${BOLD_GREEN}[âœ“] Done${NO_COLOR}\n"

# Version
# =========================================================
VERSION="${GRAY}v0.0.1${NO_COLOR}"

# Header
# =========================================================
echo "${BOLD_WHITE}@thiagobraga's dotfiles${NO_COLOR} ${VERSION}\n"

# Install Oh My ZSH
# =========================================================
{
  echo "ðŸ›   ${BOLD_WHITE}Install Oh My ZSH"
  echo "${INFO} Checking if it is installed"
  if [[ ! -d "${ZSH}" ]]; then
    echo "${INFO} Installing..."
    sh -c \
      $(curl -fsSL \
        https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh)
  else
    echo "${SUCCESS} Already installed."
    echo "${INFO} Updating..."
    cd ${ZSH} || exit
    git pull origin master
    cd -
  fi
  echo "${DONE}"
}

# Install Spaceship theme
# =========================================================
{
  echo "ðŸ›   ${BOLD_WHITE}Install Spaceship theme"
  echo "${INFO} Checking if it is installed"
  THEME_PATH="${ZSH_CUSTOM:-${ZSH}/custom}/themes/spaceship-prompt"
  if [[ ! -d "${THEME_PATH}" ]]; then
    git clone \
      https://github.com/denysdovhan/spaceship-prompt \
      ${THEME_PATH}
    ln -s ${THEME_PATH}/spaceship.zsh-theme \
      ${ZSH}/themes/spaceship.zsh-theme
  else
    echo "${SUCCESS} Already installed."
    echo "${INFO} Updating..."
    cd ${THEME_PATH} || exit
    git pull origin master
    cd -
  fi
  echo "${DONE}"
}

# Install zsh-syntax-highlight plugin
# =========================================================
{
  echo "ðŸ›   ${BOLD_WHITE}Install zsh-syntax-highlight plugin"
  echo "${INFO} Checking if it is installed"
  PLUGIN_PATH="${ZSH_CUSTOM:-${HOME}/.oh-my-zsh/custom}/plugins/zsh-syntax-highlighting"
  if [[ ! -d "${PLUGIN_PATH}" ]]; then
    git clone \
      https://github.com/zsh-users/zsh-syntax-highlighting \
      ${PLUGIN_PATH}
  else
    echo "${SUCCESS} Already installed."
    echo "${INFO} Updating..."
    git --work-tree=${PLUGIN_PATH} pull origin master
  fi
  echo "${DONE}"
}

# Install zsh-autosuggestions
# =========================================================
{
  echo "ðŸ›   ${BOLD_WHITE}Install zsh-autosuggestions"
  echo "${INFO} Checking if it is installed"
  PLUGIN_PATH="${ZSH_CUSTOM:-${HOME}/.oh-my-zsh/custom}/plugins/zsh-autosuggestions"
  if [[ ! -d "${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-autosuggestions" ]]; then
    git clone \
      https://github.com/zsh-users/zsh-autosuggestions \
      ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-autosuggestions
  else
    echo "${SUCCESS} Already installed."
    echo "${INFO} Updating..."
    git --work-tree=${PLUGIN_PATH} pull origin master
  fi
  echo "${DONE}"
}

# Create symbolic links for configurations
# =========================================================
{
  echo "ðŸ›   ${BOLD_WHITE}Install zsh-autosuggestions"
  echo "${INFO} Print a backup of old configurations"
  gsettings get org.gnome.desktop.session idle-delay
  gsettings get org.gnome.desktop.screensaver lock-enabled
  # gsettings get com.canonical.indicator.session suppress-logout-restart-shutdown
  echo "${SUCCESS} Modifying configurations"
  gsettings set org.gnome.desktop.session idle-delay 0
  gsettings set org.gnome.desktop.screensaver lock-enabled false
  # gsettings set com.canonical.indicator.session suppress-logout-restart-shutdown true
  echo "${DONE}"
}

# "Restart to Windows" shortcut
# =========================================================
# {
#   echo -e '\nðŸ›   Creating "Restart to Windows" shortcuts'
#   sudo cp -f ./shortcuts/windows.png \
#     ./shortcuts/windows.sh \
#     ./shortcuts/windows.desktop \
#     /usr/share/applications/

#   sudo chmod 644 /usr/share/applications/windows.{sh,desktop,png}
#   sudo chmod -x /usr/share/applications/windows.desktop
#   sudo chmod +x /usr/share/applications/windows.sh
#   echo 'âœ…  Done'
# }
